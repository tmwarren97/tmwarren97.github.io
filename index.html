<!doctype html>
<html class="no-js" lang="">

<head>
    <meta charset="utf-8">
    <title>Pool Status</title>
    <meta name="theme-color" content="#fafafa">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        * {
            box-sizing: border-box;
        }

        .row::after {
            content: "";
            clear: both;
            display: table;
        }

        [class*="col-"] {
            float: left;
            padding: 15px;
            text-align: center;
        }

        .col-1 {
            width: 8.33%;
        }

        .col-2 {
            width: 16.66%;
        }

        .col-3 {
            width: 25%;
        }

        .col-4 {
            width: 33.33%;
        }

        .col-5 {
            width: 41.66%;
        }

        .col-6 {
            width: 50%;
        }

        .col-7 {
            width: 58.33%;
        }

        .col-8 {
            width: 66.66%;
        }

        .col-9 {
            width: 75%;
        }

        .col-10 {
            width: 83.33%;
        }

        .col-11 {
            width: 91.66%;
        }

        .col-12 {
            width: 100%;
        }

        html {
            font-family: "Lucida Sans", sans-serif;
        }

        .header {
            background-color: #9933cc;
            color: #ffffff;
            padding: 15px;
        }

        .menu ul {
            list-style-type: none;
            margin: 0;
            padding: 0;
        }

        .menu li {
            padding: 8px;
            margin-bottom: 7px;
            background-color: #33b5e5;
            color: #ffffff;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);
        }

        .menu li:hover {
            background-color: #0099cc;
        }
    </style>

    <script>
        // [row][column]
        var pool1 = new Array(10).fill("").map(() => new Array(10).fill(""));
        var pool2 = new Array(10).fill("").map(() => new Array(10).fill(""));

        function addRowToPool1(rowIndex, colArray) {
            pool1[rowIndex][0] = colArray[0];
            pool1[rowIndex][6] = colArray[1];
            pool1[rowIndex][3] = colArray[2];
            pool1[rowIndex][2] = colArray[3];
            pool1[rowIndex][4] = colArray[4];
            pool1[rowIndex][1] = colArray[5];
            pool1[rowIndex][9] = colArray[6];
            pool1[rowIndex][8] = colArray[7];
            pool1[rowIndex][5] = colArray[8];
            pool1[rowIndex][7] = colArray[9];
        }

        function addRowToPool2(rowIndex, colArray) {
            pool2[rowIndex][9] = colArray[0];
            pool2[rowIndex][2] = colArray[1];
            pool2[rowIndex][6] = colArray[2];
            pool2[rowIndex][3] = colArray[3];
            pool2[rowIndex][8] = colArray[4];
            pool2[rowIndex][5] = colArray[5];
            pool2[rowIndex][0] = colArray[6];
            pool2[rowIndex][7] = colArray[7];
            pool2[rowIndex][1] = colArray[8];
            pool2[rowIndex][4] = colArray[9];
        }

        addRowToPool1(8, ["Juan BMS",     "Rob Hakes", "Fiona",       "Allen Lites", "Benjamin",    "Ryan Gordan",          "Mike S",               "Louie Lites",      "Mary W.",      "Matt Furey"]);
        addRowToPool1(6, ["Catherine F.", "Haylie W.", "L.K.",        "Bill BMS",    "David M",     "Joe H.",               "Ryan Gordan (mom)",    "Ryan Gordan",      "Valerie R.",   "Mike H."]);
        addRowToPool1(7, ["Venssa",       "Scotty",    "Louie Rojo",  "L.K.",        "Ryan G.",     "Cooy",                 "Allen Lites",          "Linda BMS",        "Liz",          "Kelsie F."]);
        addRowToPool1(3, ["Fiona",        "Bridget",   "D Valentin",  "Louie Rojo",  "L.K.",        "Ryan Gordan (Dad)",    "Bill BMS",             "Nora",             "Latiff",       "Emily Gove"]);
        addRowToPool1(9, ["Mike & Mary",  "Linda BMS", "Steve G.",    "Alex M.",     "Louie Rojo",  "L.K.",                 "Denise L.",            "Regina",           "Mike Dashey",  "Eddie M."]);
        addRowToPool1(5, ["Sean Austin",  "Mike H.",   "Joe H.",      "Joe H.",      "Juan F. BMS", "Louie Rojo",           "L.K",                  "Aidan W.",         "Alex M.",      "Jack Price"]);
        addRowToPool1(0, ["Louie Lites",  "Mike D.",   "Scotty",      "Nora",        "Tim W.",      "Joe H.",               "Louie Rojo",           "Anthony J.",       "Jack Price",   "Mike & Mary"]);
        addRowToPool1(1, ["Phil & Maria", "Denise L.", "Mike H.",     "Regina",      "Jody",        "Rob Haker",            "Patricia F.",          "Jack Price",       "Andres T.",    "Juan F. "]);
        addRowToPool1(2, ["Mike H.",      "Sev & J.",  "Nick Fallon", "Jose Jr.",    "Emily Grove", "Steve G.",             "Jack Price",           "Susan Brandli",    "Jorge M.",     "Daniel M."]);
        addRowToPool1(4, ["Matt Furey",   "Latiff",    "Chris W.",    "Anthony J.",  "David M.",    "Jack Price",           "Mike H",               "Jose Jr.",         "Steve G.",     "Louie Lites"]);

        addRowToPool2(2, ["Juan BMS",       "Valerie R.",           "Ryan G.",          "Kathy N.",     "Ryan G.",      "Joe H",          "Joe H",              "Jody",         "Mary W.",      "Matt Furey"]);
        addRowToPool2(1, ["Catherine F.",   "Haylie W.",            "L.K.",             "Fiona",        "Fiona",        "Joe H",          "Ryan Gordan (mom)",  "Kathy N.",     "Scotty",       "David M."]);
        addRowToPool2(9, ["DValen",         "Scotty",               "Louie Rojo",       "L.K.",         "Fiona",        "Eddie M.",       "Fiona",              "Vanessa",      "Liz",          "Bridget"]);
        addRowToPool2(3, ["David M.",       "Fiona",                "John Shea",        "Louie Rojo",   "L.K.",         "Louie Lites",    "Alex M",             "Cody",         "Danise",       "Latiff"]);
        addRowToPool2(7, ["Mike & Mary",    "Kathy & Ann Marie",    "Regina",           "Anthony J.",   "Louis Rojo",   "L.K.",           "Linda BMS",          "Jose Jr",      "Rob Haker",    "Sean F."]);
        addRowToPool2(6, ["Sean Austin",    "EF",                   "Bill BMS",         "Alex M.",      "Juan F",       "Louie Rojo",     "L.K.",               "Aidan W.",     "EF BMS",       "John S."]);
        addRowToPool2(0, ["Miils D.",       "Nore BMS",             "Ryan Gordan (dad)","Armand BMS",   "Tim W.",       "Fiona",          "Louie Rojo",         "Anthony J.",   "Vanessa ",     "Mike & Mary"]);
        addRowToPool2(4, ["Phil & Maria",   "Benjamis Sm.",         "Davon",            "Linda BMS",    "Denise L.",    "Pat Fuller",     "Sean Fallon",        "Mike H",       "Ragina",       "Ryan G."]);
        addRowToPool2(8, ["Rob Hakes",      "Sev & J.",             "Anthony J.",       "Joe H",        "Mike H",       "Milas D.",       "Davon",              "Louie Lites",  "Jorge M.",     "Mike H."]);
        addRowToPool2(5, ["Matt Furey",     "Latiff",               "Chris W.",         "Jose Jr.",     "Mike H",       "Bill B.",        "Mike H",             "NDRU BMS",     "Cody",         "Juan F."]);


    </script>

    <script>
        const userAction = async () => {
            const response = await fetch('https://cors-anywhere.herokuapp.com/https://www.nfl.com/liveupdate/scores/scores.json');
            const myJson = await response.json(); //extract JSON from the http response
            console.log(myJson)
            var homeTeam = myJson["2020020200"].home;
            var awayTeam = myJson["2020020200"].away;
/*
            homeTeam.score["1"] = 6;
            awayTeam.score["1"] = 0;
            homeTeam.score["2"] = 3;
            awayTeam.score["2"] = 14;
            homeTeam.score["3"] = 0;
            awayTeam.score["3"] = 10;
            homeTeam.score["4"] = 5;
            awayTeam.score["4"] = 2;
*/
            var homeTeamScores = renderTeam("homeTeam", homeTeam);
            var awayTeamScores = renderTeam("awayTeam", awayTeam);
            renderTable(homeTeam, homeTeamScores, awayTeam, awayTeamScores);
            renderWhatIfs(pool1, homeTeam.abbr, homeTeamScores.endQ4Score, awayTeam.abbr, awayTeamScores.endQ4Score, 1);
            renderWhatIfs(pool2, homeTeam.abbr, homeTeamScores.endQ4Score, awayTeam.abbr, awayTeamScores.endQ4Score, 2);
        }

        function renderWhatIfs(pool, homeTeamName, homeTeamEndQ4Score, awayTeamName, awayTeamEndQ4Score, poolId) {
            var wih = `<table style='width: 100%'>
            <tr><th>Pool ${poolId}</th><th>+1</th><th>+2</th><th>+3</th><th>+6</th><th>+7</th><th>+8</th></tr>
            ${renderWhatIfAwayTeamRow(pool, awayTeamName, homeTeamEndQ4Score, awayTeamEndQ4Score)}
            ${renderWhatIfHomeTeamRow(pool, homeTeamName, homeTeamEndQ4Score, awayTeamEndQ4Score)}
            </table>`;
            upd("whatIfTable" + poolId, wih);
        }

        function renderWhatIfHomeTeamRow(pool, teamName, homeTeamEndQ4Score, awayTeamEndQ4Score) {

            return `<tr>
                <th>${teamName}</th>
                <td>${findWinner(pool, homeTeamEndQ4Score + 1, awayTeamEndQ4Score)}</td>
                <td>${findWinner(pool, homeTeamEndQ4Score + 2, awayTeamEndQ4Score)}</td>
                <td>${findWinner(pool, homeTeamEndQ4Score + 3, awayTeamEndQ4Score)}</td>
                <td>${findWinner(pool, homeTeamEndQ4Score + 6, awayTeamEndQ4Score)}</td>
                <td>${findWinner(pool, homeTeamEndQ4Score + 7, awayTeamEndQ4Score)}</td>
                <td>${findWinner(pool, homeTeamEndQ4Score + 8, awayTeamEndQ4Score)}</td>
            </tr>`;
        }

        function renderWhatIfAwayTeamRow(pool, teamName, homeTeamEndQ4Score, awayTeamEndQ4Score) {

            return `<tr>
                <th>${teamName}</th>
                <td>${findWinner(pool, homeTeamEndQ4Score, awayTeamEndQ4Score + 1)}</td>
                <td>${findWinner(pool, homeTeamEndQ4Score, awayTeamEndQ4Score + 2)}</td>
                <td>${findWinner(pool, homeTeamEndQ4Score, awayTeamEndQ4Score + 3)}</td>
                <td>${findWinner(pool, homeTeamEndQ4Score, awayTeamEndQ4Score + 6)}</td>
                <td>${findWinner(pool, homeTeamEndQ4Score, awayTeamEndQ4Score + 7)}</td>
                <td>${findWinner(pool, homeTeamEndQ4Score, awayTeamEndQ4Score + 8)}</td>
            </tr>`;
        }

        function renderTable(homeTeam, homeTeamScores, awayTeam, awayTeamScores) {
            var sh = `<table style='width: 100%'>
                    <tr><th></th><th>Q1</th><th>Q2</th><th>Q3</th><th>Q4</th></tr>
                    ${renderTeamScoreRow(awayTeam, awayTeamScores)}
                    ${renderTeamScoreRow(homeTeam, homeTeamScores)}
                    ${renderPoolRow("1", pool1, homeTeamScores, awayTeamScores)}
                    ${renderPoolRow("2", pool2, homeTeamScores, awayTeamScores)}
                </table>`;
            upd("scoreTable", sh);
        }

        function renderPoolRow(poolNumber, pool, homeTeamScores, awayTeamScores) {
            return `
                <tr>
                    <th>Pool ${poolNumber}</th>
                    <td>${findWinner(pool, homeTeamScores.endQ1Score, awayTeamScores.endQ1Score)}</td>
                    <td>${findWinner(pool, homeTeamScores.endQ2Score, awayTeamScores.endQ2Score)}</td>
                    <td>${findWinner(pool, homeTeamScores.endQ3Score, awayTeamScores.endQ3Score)}</td>
                    <td>${findWinner(pool, homeTeamScores.endQ4Score, awayTeamScores.endQ4Score)}</td>
                </tr>
            `;
        }

        function findWinner(pool, homeScore, awayScore) {
            var homeTeamIndex = homeScore % 10;
            var awayTeamIndex = awayScore % 10;
            return pool[homeTeamIndex][awayTeamIndex];
        }

        function renderTeamScoreRow(team, teamScores) {
            return `<tr>
            <th>${team.abbr}</th>
            <td>${teamScores.endQ1Score}</td>
            <td>${teamScores.endQ2Score}</td>
            <td>${teamScores.endQ3Score}</td>
            <td>${teamScores.endQ4Score}</td>
            </tr>`;
        }

        function renderTeam(id, team) {
            var q1Points = team.score["1"];
            var q2Points = team.score["2"];
            var q3Points = team.score["3"];
            var q4Points = team.score["4"];
            var q5Points = team.score["5"];
            var totalScore = team.score["T"];
            var endQ2Score = q1Points + q2Points;
            var endQ3Score = endQ2Score + q3Points;
            var endQ4Score = endQ3Score + q4Points;
            var ih = "<ul>" +
                "<h1>" + team.abbr + "</h1>" +
                "<h1>" + endQ4Score + "</h1>" +
                "</ul>";
            upd(id, ih);
            return {
                totalScore: totalScore,
                endQ1Score: q1Points,
                endQ2Score: endQ2Score,
                endQ3Score: endQ3Score,
                endQ4Score: endQ4Score
            };
        }

        function upd(id, value) {
            document.getElementById(id).innerHTML = value;
        }

        window.onload = function () {
            userAction();
        }

        var interval = setTimeout(callApi, 0);

        function callApi() {
            document.getElementById("lastUpdated").innerHTML = "Last Updated: " + new Date() + " ";
            userAction();
            interval = setTimeout(callApi, 30000);
        }

    </script>

</head>

<body>
<div class="row">
    <div class="col-6" id="awayTeam">TEST 2</div>
    <div class="col-6" id="homeTeam">TEST 1</div>
</div>

<div class="row">
  <div class="col-12" id="scoreTable">TEST 3</div>
</div>

<div class="row">
    <div class="col-12" id="whatIfTable1">TEST 3</div>
</div>

<div class="row">
    <div class="col-12" id="whatIfTable2">TEST 3</div>
</div>

<p id="lastUpdated" style="font-size:2vw; text-align: center;"></p>



</body>

</html>
